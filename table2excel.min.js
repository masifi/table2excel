class Table2Excel{constructor(e,t={}){this.element=document.querySelectorAll(e),this.settings={},this.settings.exclude=void 0!==t.exclude&&""!==t.exclude?t.exclude:".skip",this.settings.name=void 0!==t.name&&""!==t.name?t.name:"table2excel",this.settings.filename=void 0!==t.filename&&""!==t.filename?t.filename:"table2excel"}export(){this.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>',sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"},this.tableRows=[],this.element.forEach((e,t)=>{var s="";e.querySelectorAll("tr:not("+this.settings.exclude+")").forEach((e,t)=>{s+="<tr>"+e.innerHTML+"</tr>"}),this.tableRows.push(s)}),this.tableToExcel(this.tableRows,this.settings.name,this.settings.sheetName)}tableToExcel(e,t,s){var i,a,l,o="";if(this.uri="data:application/vnd.ms-excel;base64,",this.base64=function(e){return window.btoa(unescape(encodeURIComponent(e)))},this.format=function(e,t){return e.replace(/{(\w+)}/g,function(e,s){return t[s]})},s=void 0===s?"Sheet":s,this.ctx={worksheet:t||"Worksheet",table:e,sheetName:s},o=this.template.head,Array.isArray(e))for(i in e)o+=this.template.sheet.head+s+i+this.template.sheet.tail;if(o+=this.template.mid,Array.isArray(e))for(i in e)o+=this.template.table.head+"{table"+i+"}"+this.template.table.tail;for(i in o+=this.template.foot,e)this.ctx["table"+i]=e[i];if(delete this.ctx.table,"undefined"!=typeof msie&&msie>0||navigator.userAgent.match(/Trident.*rv\:11\./))if("undefined"!=typeof Blob){o=[o];var n=new Blob(o,{type:"text/html"});window.navigator.msSaveBlob(n,this.getFileName(this.settings))}else txtArea1.document.open("text/html","replace"),txtArea1.document.write(this.format(o,this.ctx)),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,this.getFileName(this.settings));else a=this.uri+this.base64(this.format(o,this.ctx)),(l=document.createElement("a")).download=this.getFileName(this.settings),l.href=a,document.body.appendChild(l),l.click(),document.body.removeChild(l);return!0}getFileName(){return(this.settings.filename?this.settings.filename:"table2excel")+(this.settings.fileext?this.settings.fileext:".xls")}}
